<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malla Interactiva - Plan de Estudios Vertical</title>
  <style>
    body {
      font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
      background: linear-gradient(135deg, #e0e7ff, #a5b8ff);
      margin: 0; padding: 25px;
      color: #0b2e7f;
      user-select: none;
    }
    h1 {
      text-align: center;
      margin-bottom: 35px;
      color: #0b3d91;
      text-shadow: 1px 1px 3px #aac1ff;
      font-weight: 700;
      letter-spacing: 1.5px;
    }

    /* Contenedor principal en flex horizontal para columnas */
    #planEstudios {
      display: flex;
      gap: 25px;
      justify-content: center;
      flex-wrap: nowrap;
      overflow-x: auto;
      padding-bottom: 15px;
    }

    .year-container {
      border: 2.5px solid #2853c8;
      border-radius: 10px;
      padding: 15px 18px;
      background: #c9d6ffcc;
      box-shadow: 3px 4px 10px #7b8bc1aa;
      min-width: 180px;
      max-height: 80vh;
      overflow-y: auto;
      display: flex;
      flex-direction: column;
      align-items: center;
    }
    .year-container:hover {
      box-shadow: 5px 7px 18px #5479ffcc;
    }
    .year-title {
      font-size: 1.9em;
      margin-bottom: 15px;
      border-bottom: 3px solid #1740c1;
      padding-bottom: 8px;
      font-weight: 600;
      color: #1740c1;
      text-shadow: 0 0 5px #3a57a9;
      width: 100%;
      text-align: center;
      user-select: text;
    }
    .subject {
      background: #d3dbff;
      margin: 6px 0;
      padding: 8px 12px;
      border-radius: 8px;
      cursor: pointer;
      border: 2px solid #3a57a9;
      width: 100%;
      text-align: center;
      font-weight: 600;
      color: #1a2e8f;
      box-shadow: 1px 2px 6px #2e4eb7aa;
      transition:
        background-color 0.3s ease,
        color 0.3s ease,
        box-shadow 0.3s ease,
        transform 0.15s ease;
      user-select: none;
      font-size: 0.9em;
      white-space: nowrap;
      overflow: hidden;
      text-overflow: ellipsis;
    }
    .subject:hover:not(.disabled):not(.completed) {
      background-color: #a3b6ff;
      color: #102f72;
      box-shadow: 2px 4px 10px #2444a9cc;
      transform: translateY(-2px);
    }
    .subject.disabled {
      cursor: not-allowed;
      opacity: 0.5;
      background: #9daae4;
      border-color: #7b8bc1;
      color: #555d8f;
      box-shadow: none;
      text-decoration: none !important;
    }
    .subject.completed {
      text-decoration: line-through;
      background: #2946ad;
      color: white;
      border-color: #1d2f6a;
      box-shadow: 1px 2px 8px #112255cc;
    }
    /* Scrollbar pequeño y azul para contenedores años */
    .year-container::-webkit-scrollbar {
      width: 7px;
    }
    .year-container::-webkit-scrollbar-track {
      background: #c9d6ffcc;
      border-radius: 10px;
    }
    .year-container::-webkit-scrollbar-thumb {
      background-color: #2853c8;
      border-radius: 10px;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Plan de Estudios Vertical</h1>

  <div id="planEstudios"></div>

  <script>
    // Datos de ejemplo del plan con correlativas
    const materias = [
      { id: 'mat1', nombre: 'Introducción a la Ingeniería', año: 1, correlativas: [] },
      { id: 'mat2', nombre: 'Química I', año: 1, correlativas: [] },
      { id: 'mat3', nombre: 'Complementos de Matemáticas', año: 1, correlativas: [] },
      { id: 'mat4', nombre: 'Cálculo Elemental', año: 1, correlativas: ['mat3'] },
      { id: 'mat5', nombre: 'Informática General', año: 1, correlativas: [] },
      { id: 'mat6', nombre: 'Química II', año: 2, correlativas: ['mat2'] },
      { id: 'mat7', nombre: 'Álgebra y Geometría', año: 2, correlativas: ['mat3'] },
      { id: 'mat8', nombre: 'Representación Gráfica Digital', año: 2, correlativas: [] },
      { id: 'mat9', nombre: 'Física I', año: 2, correlativas: ['mat4'] },
      // Podés agregar todas las materias de tu plan con correlativas y año...
    ];

    const años = [...new Set(materias.map(m => m.año))].sort();

    const estadoGuardado = JSON.parse(localStorage.getItem('estadoMaterias')) || {};

    const planDiv = document.getElementById('planEstudios');

    function estaHabilitada(materia) {
      if (materia.correlativas.length === 0) return true;
      return materia.correlativas.every(idCorrelativa => estadoGuardado[idCorrelativa] === true);
    }

    function renderizarMaterias() {
      planDiv.innerHTML = '';

      años.forEach(año => {
        const contenedorAño = document.createElement('div');
        contenedorAño.classList.add('year-container');

        const tituloAño = document.createElement('h2');
        tituloAño.classList.add('year-title');
        tituloAño.textContent = `Año ${año}`;
        contenedorAño.appendChild(tituloAño);

        const materiasDelAño = materias.filter(m => m.año === año);

        materiasDelAño.forEach(materia => {
          const divMateria = document.createElement('div');
          divMateria.classList.add('subject');
          divMateria.id = materia.id;
          divMateria.textContent = materia.nombre;

          const habilitada = estaHabilitada(materia);
          if (!habilitada) {
            divMateria.classList.add('disabled');
          }

          if (estadoGuardado[materia.id]) {
            divMateria.classList.add('completed');
          }

          divMateria.addEventListener('click', () => {
            if (!estaHabilitada(materia)) return;

            if (estadoGuardado[materia.id]) {
              estadoGuardado[materia.id] = false;
            } else {
              estadoGuardado[materia.id] = true;
            }
            localStorage.setItem('estadoMaterias', JSON.stringify(estadoGuardado));
            renderizarMaterias();
          });

          contenedorAño.appendChild(divMateria);
        });

        planDiv.appendChild(contenedorAño);
      });
    }

    renderizarMaterias();
  </script>
</body>
</html>
