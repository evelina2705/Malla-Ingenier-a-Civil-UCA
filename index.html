<!DOCTYPE html>
<html lang="es">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Malla Interactiva - Plan de Estudios</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #e8f0fe;
      margin: 0; padding: 20px;
      color: #0b3d91;
    }
    h1 {
      text-align: center;
      margin-bottom: 30px;
    }
    .year-container {
      margin-bottom: 40px;
      border: 2px solid #0b3d91;
      border-radius: 8px;
      padding: 15px;
      background: #c9d9f6;
    }
    .year-title {
      font-size: 1.8em;
      margin-bottom: 15px;
      border-bottom: 2px solid #0b3d91;
      padding-bottom: 5px;
    }
    .subject {
      background: #d6e2ff;
      margin: 8px 5px;
      padding: 10px 15px;
      border-radius: 6px;
      display: inline-block;
      cursor: pointer;
      user-select: none;
      transition: background-color 0.3s ease;
      border: 1.5px solid #2c4a9f;
      min-width: 160px;
    }
    .subject.disabled {
      cursor: not-allowed;
      opacity: 0.5;
      background: #a9bbf5;
      border-color: #7b8bc1;
      text-decoration: none !important;
    }
    .subject.completed {
      text-decoration: line-through;
      background: #3a57a9;
      color: white;
      border-color: #20396c;
    }
    .subject:hover:not(.disabled):not(.completed) {
      background-color: #acc8ff;
    }
  </style>
</head>
<body>
  <h1>Malla Interactiva - Plan de Estudios</h1>

  <div id="planEstudios"></div>

  <script>
    // Datos del plan con correlativas
    // El formato es: id, nombre, año, correlativas (array con ids de materias previas)
    const materias = [
      { id: 'mat1', nombre: 'Introducción a la Ingeniería', año: 1, correlativas: [] },
      { id: 'mat2', nombre: 'Química I', año: 1, correlativas: [] },
      { id: 'mat3', nombre: 'Complementos de Matemáticas', año: 1, correlativas: [] },
      { id: 'mat4', nombre: 'Cálculo Elemental', año: 1, correlativas: ['mat3'] },
      { id: 'mat5', nombre: 'Informática General', año: 1, correlativas: [] },
      { id: 'mat6', nombre: 'Química II', año: 2, correlativas: ['mat2'] },
      { id: 'mat7', nombre: 'Álgebra y Geometría', año: 2, correlativas: ['mat3'] },
      { id: 'mat8', nombre: 'Representación Gráfica Digital', año: 2, correlativas: [] },
      { id: 'mat9', nombre: 'Física I', año: 2, correlativas: ['mat4'] },
      // Agregá todas las materias de tu plan con su año y correlativas...
    ];

    // Organizar materias por año
    const años = [...new Set(materias.map(m => m.año))].sort();

    // Estado guardado en localStorage para mantener tachados aunque recargues
    const estadoGuardado = JSON.parse(localStorage.getItem('estadoMaterias')) || {};

    const planDiv = document.getElementById('planEstudios');

    // Función para chequear si una materia está habilitada (tiene todas las correlativas aprobadas)
    function estaHabilitada(materia) {
      if (materia.correlativas.length === 0) return true; // Sin correlativas, siempre habilitada
      return materia.correlativas.every(idCorrelativa => estadoGuardado[idCorrelativa] === true);
    }

    // Renderizar materias
    function renderizarMaterias() {
      planDiv.innerHTML = ''; // limpio contenido

      años.forEach(año => {
        const contenedorAño = document.createElement('div');
        contenedorAño.classList.add('year-container');

        const tituloAño = document.createElement('h2');
        tituloAño.classList.add('year-title');
        tituloAño.textContent = `Año ${año}`;
        contenedorAño.appendChild(tituloAño);

        const materiasDelAño = materias.filter(m => m.año === año);

        materiasDelAño.forEach(materia => {
          const divMateria = document.createElement('div');
          divMateria.classList.add('subject');
          divMateria.id = materia.id;
          divMateria.textContent = materia.nombre;

          const habilitada = estaHabilitada(materia);
          if (!habilitada) {
            divMateria.classList.add('disabled');
          }

          if (estadoGuardado[materia.id]) {
            divMateria.classList.add('completed');
          }

          divMateria.addEventListener('click', () => {
            if (!estaHabilitada(materia)) return; // No hacer nada si no está habilitada

            if (estadoGuardado[materia.id]) {
              // Si ya está tildada, la destildo
              estadoGuardado[materia.id] = false;
            } else {
              // Tildo la materia
              estadoGuardado[materia.id] = true;
            }
            // Guardar estado en localStorage
            localStorage.setItem('estadoMaterias', JSON.stringify(estadoGuardado));
            // Volver a renderizar para actualizar estados
            renderizarMaterias();
          });

          contenedorAño.appendChild(divMateria);
        });

        planDiv.appendChild(contenedorAño);
      });
    }

    // Inicializar renderizado
    renderizarMaterias();

  </script>
</body>
</html>
